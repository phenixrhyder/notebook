# Phenix Rhyder/ 
name: Deploy Python App to Hugging Face Spaces

on:
  push:
    branches:
      - main

jobs:
  deploy-to-hub:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          lfs: true

      # NEW DIAGNOSTIC STEP
      # This step will try to use the token to log in and print your username.
      - name: Test Hugging Face Token
        env:
          HF_TOKEN: ${{ secrets.HF_TOKEN }}
        run: |
          # Install the huggingface command-line tool
          pip install -U "huggingface_hub[cli]"
          
          # Use the token to log in and ask "who am I?"
          # If this command fails, the token is definitely invalid.
          echo "--- Testing the token now ---"
          huggingface-cli whoami
          echo "--- Test complete ---"

      # This is the original push command. It will run after the test.
      - name: Push to Hugging Face Hub
        env:
          HF_TOKEN: ${{ secrets.HF_TOKEN }}
        run: |
          git remote add space https://user:${HF_TOKEN}@huggingface.co/spaces/phenixrhyder/phenixrhyder
          git push --force space main
