# PhenixRhyder/ Checkerboard Pattern
name: Deploy React App to Hugging Face Spaces

# This action will trigger on every push to the 'main' branch
on:
  push:
    branches:
      - main # Or 'master' depending on your repository's default branch

# Jobs to be executed
jobs:
  build-and-deploy:
    # Use the latest version of Ubuntu as the operating system
    runs-on: ubuntu-latest

    steps:
      # 1. Check out your repository code so the workflow can access it
      - name: Checkout code
        uses: actions/checkout@v4

      # 2. Diagnostic Step: List all files to find package.json
      - name: List files in repository
        run: ls -R

      # 3. Set up Node.js, which is required to build a React app
      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      # 4. Install the project dependencies (like React)
      - name: Install dependencies
        # This tells the Action to run the command inside the 'notebook' folder
        working-directory: ./notebook
        run: npm install

      # 5. Build the React application for production
      - name: Build application
        # This also runs inside the 'notebook' folder
        working-directory: ./notebook
        run: npm run build

      # 6. Upload the 'build' folder to your Hugging Face Space using the official library
      - name: Push to Hugging Face Hub
        env:
          # This uses the secret token you created
          HF_TOKEN: ${{ secrets.HF_TOKEN }}
        run: |
          # Install the huggingface_hub library
          pip install huggingface-hub

          # Run a Python script to upload the folder
          python -c "
          from huggingface_hub import HfApi
          api = HfApi(token='$HF_TOKEN')
          api.upload_folder(
              # Point to the 'build' folder that was created inside the 'notebook' subfolder
              folder_path='notebook/build',
              repo_id='phenixrhyder/ phenixrhyder',
              repo_type='space'
          )
          "
